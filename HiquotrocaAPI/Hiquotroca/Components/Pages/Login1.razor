@page "/login1"
@using Hiquotroca.Dtos
@inject Hiquotroca.Services.AuthApiService AuthService
@inject NavigationManager Nav

<MudContainer MaxWidth="MaxWidth.False"
              Class="pa-4"
              Style="width:100%;height:100vh;background:white;overflow-y:auto;">

    <div style="display:flex;justify-content:center;margin-top:40px;">
        <MudImage Src="images/Fox.png" Style="width:110px;" />
    </div>

    <MudText Typo="Typo.h4"
             Align="Align.Center"
             Color="Color.Warning"
             Style="font-weight:bold;margin-top:10px;margin-bottom:32px;">
        Sign In
    </MudText>

    <MudTextField @bind-Value="model.Email"
                  Label="Email/Telemóvel"
                  Placeholder="Email / Telemóvel"
                  Variant="Variant.Outlined"
                  Class="campo mb-3" />

    <MudTextField @bind-Value="model.Password"
                  Label="Palavra passe"
                  InputType="InputType.Password"
                  Placeholder="********"
                  Variant="Variant.Outlined"
                  Class="campo mb-3" />

    <MudButton Variant="Variant.Filled"
               Color="Color.Warning"
               FullWidth="true"
               OnClick="Login"
               Style="margin-top:20px;text-transform:none;font-weight:bold;border-radius:10px;padding:12px;">
        Login
    </MudButton>

    @if (!string.IsNullOrWhiteSpace(message))
    {
        <MudText Color="Color.Error" Style="margin-top:10px;">@message</MudText>
    }

    <MudText Typo="Typo.body2"
             Align="Align.Left"
             Style="margin-top:18px; font-size:16px; color:#555;">
        Ainda não tem conta?
        <MudLink @onclick="IrParaSignUp"
                 Style="color:#0066cc !important; cursor:pointer;">
            Criar conta
        </MudLink>
    </MudText>

</MudContainer>

@code {
    LoginRequest model = new();
    string? message;

    async Task Login()
    {
        var (ok, msg) = await AuthService.LoginAsync(model);
        message = msg;

        if (ok)
            Nav.NavigateTo("/home", forceLoad: true);
    }

    void IrParaSignUp() => Nav.NavigateTo("/start");
}
